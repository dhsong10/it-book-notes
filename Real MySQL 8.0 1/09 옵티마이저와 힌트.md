## 09 옵티마이저와 힌트

### MySQL 서버에서 쿼리가 실행되는 과정

MySQL 서버에서 쿼리가 실행될 때에는 다음 세 단계를 거쳐서 이루어진다.

1. SQL 파서는 SQL의 구문을 파싱 해서 **파스 트리**를 만든다. 문법적 오류를 점검한다.
2. 옵티마이저는 생성된 SQL 파스 트리를 통해 최적의 **실행 계획**을 만든다.
3. MySQL엔진과 스토리지 엔진은 실행 계획에 따라서 데이터를 가져온다.

### 옵티마이저의 종류

옵티마이저의 종류는 `비용 기반 최적화(Cost-based optimizer, CBO) 방법`과 `규칙 기반 최적화(Rule-based optimizer, RBO) 방법`이 있다. 현재 대부분의 DBMS는 비용 기반 최적화를 따른다.

`비용 기반 최적화 방법`은 현재 대부분의 DBMS에서 사용하는 방법으로 MySQL도 사용한다. 쿼리를 처리하기 위한 여러 가지 가능한 방법을 만든다. 통계 정보를 사용해서 각 방법으로 쿼리를 실행했을 때의 비용을 산출한다. 가능한 방법 중 비용이 최소인 방법을 실행 계획으로 선택한다.

`규칙 기반 최적화 방법`은 오라클 DBMS에서 사용했던 방법이다. 통계 정보를 이용하지 않고 내장된 우선순위에 따라서 실행 계획을 만든다. 따라서, 같은 쿼리에 대해서는 거의 항상 같은 실행 계획이 선택된다.